<html>

<body>
    <h1 id="dies">asd</h1>
    <span>Wafer Diameter: </span>
    <input id="waferDiameter" value="500">
    <span>dieWidth: </span>
    <input id="dieWidthInput" value="12">
    <span>dieHeight: </span>
    <input id="dieHeightInput" value="12">
    <span>dieGap: </span>
    <input id="dieGap" value="1">
    <button onclick="draw()">Render</button>
    <canvas id="canvas" width="2000px" height="2000px">
    </canvas>
</body>
<footer>
    <script>
        function getRandomInt(max) {
                return Math.floor(Math.random() * max);
            }
        function draw() {
            var working =0
            var defect = 0
            var outside = 0
            var total = 0

            var gap = parseInt(document.getElementById('dieGap').value)
            var dieWidth = parseInt(document.getElementById('dieWidthInput').value)
            var dieHeight = parseInt(document.getElementById('dieHeightInput').value)
            var waferDiameter = parseFloat(document.getElementById('waferDiameter').value)
            var cX = waferDiameter / 2
            var cY = waferDiameter / 2
            var cR = waferDiameter / 2


            var canvas = document.getElementById('canvas');
            if (canvas.getContext) {
                var ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.beginPath();
                ctx.arc(cX, cY, cR, Math.PI * 2, false)
                
                for (x = 0; x < cR*2; x += dieWidth+ gap)
                    for (y = 0; y < cR*2; y += dieHeight+ gap) {
                        var rTL = x
                        var rTR = x + dieWidth
                        var rBL = y
                        var rBR = y + dieHeight

                        dx = Math.max(cX - rTL, rTR - cX);
                        dy = Math.max(cY - rBL, rBR - cY);
                        if (cR * cR >= dx * dx + dy * dy) 
                        {
                            if (getRandomInt(100) > 75) {
                                ctx.fillStyle = 'gray';
                                defect++
                                total++
                            }
                            else{
                                ctx.fillStyle = 'green'
                                working++
                                total++
                            }
                        }
                        else
                            {
                                ctx.fillStyle = 'transparent';
                                outside++
                            }

                        ctx.fillRect(x, y, dieWidth, dieHeight)
                    }
                ctx.stroke();
            }
            var h1 = document.getElementById("dies");
            h1.innerText = "Total Dies: "+total+", Working: "+working+", Defects: "+defect;
        }
        draw()
    </script>
</footer>

</html>